<html>
  <head>
    <script>
      function _searchHandler() {
        console.log("Func-ing!");

        const input = document.getElementById('searchBar');
        const filter = input.value.toUpperCase();
        const transactionContainer = document.getElementById('transaction-container');
        const rows = Array.from(transactionContainer.querySelectorAll('.transaction-row'));

        for (row of rows) {
          const fields = Array.from(row.getElementsByTagName("td"));
          const textValues = fields.reduce(function(acc, cur) {
            acc.push(cur.textContent || cur.innerText);
            return acc;
          }, []);

          const visible = textValues.reduce(
            (acc, cur) => acc || (cur.toUpperCase().indexOf(filter) > -1),
            false,
          );
          if (visible) {
            row.style.display = "";
          } else {
            row.style.display = "none";
          }
        }
      }

      function searchHandler() {
        try {
          _searchHandler();
        } catch (err) {
          const errorPane = document.getElementById("errorPane");
          errorPane.style.display = "block";
          errorPane.innerHTML = err.toString();
          console.error(err);
        }
      }
    </script>
    <style>
      table {
        border-spacing: 3px;
      }

      #errorPane {
        background-color: #ffa0a0;
        padding: 1em; display: none;
      }

      #searchBar {
        padding: 12px 20px 12px 40px;
      }
    </style>
  </head>
  <body>
    <div id="errorPane"></div>
    <input type="text" id="searchBar" onkeyup="searchHandler()" placeholder="Search...">

    <table class="container" id="transaction-container">
      {{range .}}
      <tr class="transaction-row">
        <td>{{ "2006-01-02" | .Date.Format }}</td>
        <td>{{.Account}}</td>
        <td>{{.Payee}}</td>
        <td>{{.Amount}}</td>
      </tr>
      {{end}}
    </table>

  </body>
</html>
